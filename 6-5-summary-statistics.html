<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="" />
<meta property="og:type" content="book" />








<meta name="description" content="">

<title></title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#preface"><span class="toc-section-number">1</span> Preface</a><ul>
<li><a href="1-1-prerequisites.html#prerequisites"><span class="toc-section-number">1.1</span> Prerequisites</a></li>
<li><a href="1-2-installing-r.html#installing-r"><span class="toc-section-number">1.2</span> Installing R</a></li>
<li><a href="1-3-installing-rstudio.html#installing-rstudio"><span class="toc-section-number">1.3</span> Installing RStudio</a></li>
<li class="has-sub"><a href="1-4-installing-r-packages-in-rstudio-.html#installing-r-packages-in-rstudio."><span class="toc-section-number">1.4</span> Installing R packages in RStudio.</a><ul>
<li><a href="1-4-installing-r-packages-in-rstudio-.html#standard-packages"><span class="toc-section-number">1.4.1</span> Standard packages</a></li>
<li><a href="1-4-installing-r-packages-in-rstudio-.html#bioconductor"><span class="toc-section-number">1.4.2</span> Bioconductor</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="2-motivation.html#motivation"><span class="toc-section-number">2</span> Motivation</a><ul>
<li><a href="2-1-variability-in-measurements.html#variability-in-measurements"><span class="toc-section-number">2.1</span> Variability in measurements</a></li>
<li><a href="2-2-summarising-your-data-can-lead-to-wrong-conclusions.html#summarising-your-data-can-lead-to-wrong-conclusions"><span class="toc-section-number">2.2</span> Summarising your data can lead to wrong conclusions</a></li>
<li><a href="2-3-ggplot2-an-r-package-for-beautiful-visualisations.html#ggplot2-an-r-package-for-beautiful-visualisations"><span class="toc-section-number">2.3</span> <em>ggplot2</em> An R package for beautiful visualisations</a></li>
</ul></li>
<li class="has-sub"><a href="3-r-fundamentals.html#r-fundamentals"><span class="toc-section-number">3</span> R Fundamentals</a><ul>
<li><a href="3-1-about-this-chapter.html#about-this-chapter"><span class="toc-section-number">3.1</span> About this chapter</a></li>
<li><a href="3-2-working-with-r.html#working-with-r"><span class="toc-section-number">3.2</span> Working with R</a></li>
<li class="has-sub"><a href="3-3-variables.html#variables"><span class="toc-section-number">3.3</span> Variables</a><ul>
<li><a href="3-3-variables.html#using-objects-and-functions"><span class="toc-section-number">3.3.1</span> Using objects and functions</a></li>
</ul></li>
<li><a href="3-4-quiz.html#quiz"><span class="toc-section-number">3.4</span> Quiz</a></li>
</ul></li>
<li class="has-sub"><a href="4-ggplot2-tour.html#ggplot2-tour"><span class="toc-section-number">4</span> <em>ggplot2</em> Tour</a><ul>
<li><a href="4-1-about-this-chapter-1.html#about-this-chapter-1"><span class="toc-section-number">4.1</span> About this chapter</a></li>
<li class="has-sub"><a href="4-2-building-a-plot-with-ggplot2.html#building-a-plot-with-ggplot2"><span class="toc-section-number">4.2</span> Building a plot with <em>ggplot2</em></a><ul>
<li><a href="4-2-building-a-plot-with-ggplot2.html#loading-the-iris-test-data"><span class="toc-section-number">4.2.1</span> Loading the iris test data</a></li>
<li><a href="4-2-building-a-plot-with-ggplot2.html#a-first-plot"><span class="toc-section-number">4.2.2</span> A first plot</a></li>
</ul></li>
<li><a href="4-3-mappings-versus-assignment.html#mappings-versus-assignment"><span class="toc-section-number">4.3</span> Mappings versus assignment</a></li>
<li><a href="4-4-quiz-1.html#quiz-1"><span class="toc-section-number">4.4</span> Quiz</a></li>
</ul></li>
<li class="has-sub"><a href="5-common-geoms.html#common-geoms"><span class="toc-section-number">5</span> Common Geoms</a><ul>
<li><a href="5-1-about-this-chapter-2.html#about-this-chapter-2"><span class="toc-section-number">5.1</span> About this chapter</a></li>
<li class="has-sub"><a href="5-2-continuous-geoms.html#continuous-geoms"><span class="toc-section-number">5.2</span> Continuous geoms</a><ul>
<li><a href="5-2-continuous-geoms.html#geom_smooth"><span class="toc-section-number">5.2.1</span> geom_smooth()</a></li>
<li><a href="5-2-continuous-geoms.html#whats-the-r2"><span class="toc-section-number">5.2.2</span> Whatâ€™s the r<sup>2</sup>?</a></li>
<li><a href="5-2-continuous-geoms.html#geom_jitter"><span class="toc-section-number">5.2.3</span> geom_jitter()</a></li>
<li><a href="5-2-continuous-geoms.html#changing-opacity"><span class="toc-section-number">5.2.4</span> Changing opacity</a></li>
<li><a href="5-2-continuous-geoms.html#geom_histogram"><span class="toc-section-number">5.2.5</span> geom_histogram()</a></li>
</ul></li>
<li class="has-sub"><a href="5-3-discrete-geoms.html#discrete-geoms"><span class="toc-section-number">5.3</span> Discrete geoms</a><ul>
<li><a href="5-3-discrete-geoms.html#geom_point-and-geom_jitter"><span class="toc-section-number">5.3.1</span> geom_point() and geom_jitter()</a></li>
<li><a href="5-3-discrete-geoms.html#geom_boxplot-and-geom_violin"><span class="toc-section-number">5.3.2</span> geom_boxplot() and geom_violin()</a></li>
</ul></li>
<li><a href="5-4-quiz-2.html#quiz-2"><span class="toc-section-number">5.4</span> Quiz</a></li>
</ul></li>
<li class="has-sub"><a href="6-using-factors-to-subset-data-and-plots.html#using-factors-to-subset-data-and-plots"><span class="toc-section-number">6</span> Using Factors to Subset Data and Plots</a><ul>
<li><a href="6-1-about-this-chapter-3.html#about-this-chapter-3"><span class="toc-section-number">6.1</span> About this chapter</a></li>
<li><a href="6-2-factors.html#factors"><span class="toc-section-number">6.2</span> Factors</a></li>
<li><a href="6-3-colouring-by-factors.html#colouring-by-factors"><span class="toc-section-number">6.3</span> Colouring by factors</a></li>
<li><a href="6-4-small-multiple-plots.html#small-multiple-plots"><span class="toc-section-number">6.4</span> Small multiple plots</a></li>
<li><a href="6-5-summary-statistics.html#summary-statistics"><span class="toc-section-number">6.5</span> Summary Statistics</a></li>
<li><a href="6-6-quiz-3.html#quiz-3"><span class="toc-section-number">6.6</span> Quiz</a></li>
</ul></li>
<li class="has-sub"><a href="7-using-rmarkdown-for-reproducible-publishable-plots.html#using-rmarkdown-for-reproducible-publishable-plots"><span class="toc-section-number">7</span> Using RMarkdown for Reproducible Publishable Plots</a><ul>
<li><a href="7-1-about-this-chapter-4.html#about-this-chapter-4"><span class="toc-section-number">7.1</span> About this chapter</a></li>
<li><a href="7-2-being-lazy-is-a-virtue-work-hard-to-be-lazy-.html#being-lazy-is-a-virtue.-work-hard-to-be-lazy."><span class="toc-section-number">7.2</span> Being lazy is a virtue. Work hard to be lazy.</a></li>
<li class="has-sub"><a href="7-3-r-markdown.html#r-markdown"><span class="toc-section-number">7.3</span> R Markdown</a><ul>
<li><a href="7-3-r-markdown.html#a-new-r-markdown-document"><span class="toc-section-number">7.3.1</span> A new R Markdown document</a></li>
</ul></li>
<li><a href="7-4-quiz-4.html#quiz-4"><span class="toc-section-number">7.4</span> Quiz</a></li>
</ul></li>
<li class="has-sub"><a href="8-visual-customisation.html#visual-customisation"><span class="toc-section-number">8</span> Visual Customisation</a><ul>
<li><a href="8-1-themes.html#themes"><span class="toc-section-number">8.1</span> Themes</a></li>
<li><a href="8-2-quiz-5.html#quiz-5"><span class="toc-section-number">8.2</span> Quiz</a></li>
<li><a href="8-3-the-theme-function.html#the-theme-function"><span class="toc-section-number">8.3</span> The <code>theme()</code> function</a></li>
<li><a href="8-4-changing-the-order-of-categories-in-the-plot.html#changing-the-order-of-categories-in-the-plot"><span class="toc-section-number">8.4</span> Changing the order of categories in the plot</a></li>
<li><a href="8-5-changing-the-limits-of-a-continuous-scale.html#changing-the-limits-of-a-continuous-scale"><span class="toc-section-number">8.5</span> Changing the limits of a continuous scale</a></li>
<li><a href="8-6-quiz-6.html#quiz-6"><span class="toc-section-number">8.6</span> Quiz</a></li>
</ul></li>
<li class="has-sub"><a href="9-loading-your-own-data.html#loading-your-own-data"><span class="toc-section-number">9</span> Loading your own data</a><ul>
<li><a href="9-1-tidy-data.html#tidy-data"><span class="toc-section-number">9.1</span> Tidy data</a></li>
<li><a href="9-2-getting-your-data-into-tidy-format.html#getting-your-data-into-tidy-format"><span class="toc-section-number">9.2</span> Getting your data into tidy format</a></li>
<li><a href="9-3-loading-in-a-csv-file.html#loading-in-a-csv-file"><span class="toc-section-number">9.3</span> Loading in a CSV file</a></li>
<li class="has-sub"><a href="9-4-finding-the-file.html#finding-the-file"><span class="toc-section-number">9.4</span> Finding the file</a><ul>
<li><a href="9-4-finding-the-file.html#make-it-easy-on-yourself"><span class="toc-section-number">9.4.1</span> Make it easy on yourself</a></li>
</ul></li>
<li><a href="9-5-making-sure-the-data-types-are-correct.html#making-sure-the-data-types-are-correct"><span class="toc-section-number">9.5</span> Making sure the data types are correct</a></li>
<li><a href="9-6-quiz-7.html#quiz-7"><span class="toc-section-number">9.6</span> Quiz</a></li>
</ul></li>
<li class="has-sub"><a href="10-ggtree-a-package-for-plotting-phylogenetic-trees.html#ggtree-a-package-for-plotting-phylogenetic-trees"><span class="toc-section-number">10</span> <em>ggtree</em> a package for plotting phylogenetic trees</a><ul>
<li class="has-sub"><a href="10-1-ggtree-a-bioconductor-package-for-displaying-phylogenetic-trees.html#ggtree---a-bioconductor-package-for-displaying-phylogenetic-trees"><span class="toc-section-number">10.1</span> <code>ggtree</code> - a Bioconductor package for displaying phylogenetic trees</a><ul>
<li><a href="10-1-ggtree-a-bioconductor-package-for-displaying-phylogenetic-trees.html#labels"><span class="toc-section-number">10.1.1</span> Labels</a></li>
<li><a href="10-1-ggtree-a-bioconductor-package-for-displaying-phylogenetic-trees.html#annotating-and-colouring-clades"><span class="toc-section-number">10.1.2</span> Annotating and colouring clades</a></li>
</ul></li>
<li><a href="10-2-quiz-8.html#quiz-8"><span class="toc-section-number">10.2</span> Quiz</a></li>
</ul></li>
<li class="has-sub"><a href="11-using-the-stats-functions-in-r.html#using-the-stats-functions-in-r"><span class="toc-section-number">11</span> Using the stats functions in R</a><ul>
<li><a href="11-1-about-this-chapter-5.html#about-this-chapter-5"><span class="toc-section-number">11.1</span> About this chapter</a></li>
<li><a href="11-2-summary-statistics-1.html#summary-statistics-1"><span class="toc-section-number">11.2</span> Summary Statistics</a></li>
<li class="has-sub"><a href="11-3-the-independent-t-test.html#the-independent-t-test"><span class="toc-section-number">11.3</span> The independent <em>t</em> test</a><ul>
<li><a href="11-3-the-independent-t-test.html#effect-size-for-a-t-test."><span class="toc-section-number">11.3.1</span> Effect size for a <em>t</em> test.</a></li>
</ul></li>
<li><a href="11-4-linear-regression.html#linear-regression"><span class="toc-section-number">11.4</span> Linear regression</a></li>
<li><a href="11-5-one-way-anova.html#one-way-anova"><span class="toc-section-number">11.5</span> One Way ANOVA</a></li>
<li><a href="11-6-quiz-9.html#quiz-9"><span class="toc-section-number">11.6</span> Quiz</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="summary-statistics" class="section level2">
<h2><span class="header-section-number">6.5</span> Summary Statistics</h2>
<p>Factors are powerful things for helping us to quickly get summary statistics, and not just plots out of the data. We already saw how to generate summary statistics on a whole dataset using the <code>summary()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">summary</span>(iris)</code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
<p>But a better way to summarise by factor is with the <code>describeBy()</code> function in the <code>psych</code> package. Note you need to use <code>$</code> notation to describe the column with the factor you want to subset with.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(psych)
<span class="kw">describeBy</span>(iris, iris$Species)</code></pre></div>
<pre><code>## $setosa
##              vars  n mean   sd median trimmed  mad min max range skew
## Sepal.Length    1 50 5.01 0.35    5.0    5.00 0.30 4.3 5.8   1.5 0.11
## Sepal.Width     2 50 3.43 0.38    3.4    3.42 0.37 2.3 4.4   2.1 0.04
## Petal.Length    3 50 1.46 0.17    1.5    1.46 0.15 1.0 1.9   0.9 0.10
## Petal.Width     4 50 0.25 0.11    0.2    0.24 0.00 0.1 0.6   0.5 1.18
## Species*        5 50 1.00 0.00    1.0    1.00 0.00 1.0 1.0   0.0  NaN
##              kurtosis   se
## Sepal.Length    -0.45 0.05
## Sepal.Width      0.60 0.05
## Petal.Length     0.65 0.02
## Petal.Width      1.26 0.01
## Species*          NaN 0.00
## 
## $versicolor
##              vars  n mean   sd median trimmed  mad min max range  skew
## Sepal.Length    1 50 5.94 0.52   5.90    5.94 0.52 4.9 7.0   2.1  0.10
## Sepal.Width     2 50 2.77 0.31   2.80    2.78 0.30 2.0 3.4   1.4 -0.34
## Petal.Length    3 50 4.26 0.47   4.35    4.29 0.52 3.0 5.1   2.1 -0.57
## Petal.Width     4 50 1.33 0.20   1.30    1.32 0.22 1.0 1.8   0.8 -0.03
## Species*        5 50 2.00 0.00   2.00    2.00 0.00 2.0 2.0   0.0   NaN
##              kurtosis   se
## Sepal.Length    -0.69 0.07
## Sepal.Width     -0.55 0.04
## Petal.Length    -0.19 0.07
## Petal.Width     -0.59 0.03
## Species*          NaN 0.00
## 
## $virginica
##              vars  n mean   sd median trimmed  mad min max range  skew
## Sepal.Length    1 50 6.59 0.64   6.50    6.57 0.59 4.9 7.9   3.0  0.11
## Sepal.Width     2 50 2.97 0.32   3.00    2.96 0.30 2.2 3.8   1.6  0.34
## Petal.Length    3 50 5.55 0.55   5.55    5.51 0.67 4.5 6.9   2.4  0.52
## Petal.Width     4 50 2.03 0.27   2.00    2.03 0.30 1.4 2.5   1.1 -0.12
## Species*        5 50 3.00 0.00   3.00    3.00 0.00 3.0 3.0   0.0   NaN
##              kurtosis   se
## Sepal.Length    -0.20 0.09
## Sepal.Width      0.38 0.05
## Petal.Length    -0.37 0.08
## Petal.Width     -0.75 0.04
## Species*          NaN 0.00
## 
## attr(,&quot;call&quot;)
## by.data.frame(data = x, INDICES = group, FUN = describe, type = type)</code></pre>
<p>With this you can get a nice, comprehensive table of summary statistics across all the numerical columns, divided by the chosen factor.</p>
<p>For combinations of factors, you can use the <code>ddply()</code> function in the <code>plyr</code> package. Here you can choose a list of factors to summarise, but you must name the output columns and the R function to use. Helpfully the R function for a mean is <code>mean()</code> and the function for standard deviation is <code>sd()</code>.</p>
<p>Here, we divide up on <code>cut</code> and <code>colour</code> using the make-a-list function <code>c()</code>, we tell <code>ddply</code> we want to <code>summarise</code> and that it should add a <code>mean</code> column using the <code>mean()</code> function and an <code>sd</code> column using the <code>sd(function)</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plyr)
<span class="kw">ddply</span>(diamonds, <span class="kw">c</span>(<span class="st">&#39;cut&#39;</span>, <span class="st">&#39;color&#39;</span>), summarise, <span class="dt">mean=</span><span class="kw">mean</span>(price), <span class="dt">sd=</span><span class="kw">sd</span>(price) )</code></pre></div>
<pre><code>##          cut color     mean       sd
## 1       Fair     D 4291.061 3286.114
## 2       Fair     E 3682.312 2976.652
## 3       Fair     F 3827.003 3223.303
## 4       Fair     G 4239.255 3609.644
## 5       Fair     H 5135.683 3886.482
## 6       Fair     I 4685.446 3730.271
## 7       Fair     J 4975.655 4050.459
## 8       Good     D 3405.382 3175.149
## 9       Good     E 3423.644 3330.702
## 10      Good     F 3495.750 3202.411
## 11      Good     G 4123.482 3702.505
## 12      Good     H 4276.255 4020.660
## 13      Good     I 5078.533 4631.702
## 14      Good     J 4574.173 3707.791
## 15 Very Good     D 3470.467 3523.753
## 16 Very Good     E 3214.652 3408.024
## 17 Very Good     F 3778.820 3786.124
## 18 Very Good     G 3872.754 3861.375
## 19 Very Good     H 4535.390 4185.798
## 20 Very Good     I 5255.880 4687.105
## 21 Very Good     J 5103.513 4135.653
## 22   Premium     D 3631.293 3711.634
## 23   Premium     E 3538.914 3794.987
## 24   Premium     F 4324.890 4012.023
## 25   Premium     G 4500.742 4356.571
## 26   Premium     H 5216.707 4466.190
## 27   Premium     I 5946.181 5053.746
## 28   Premium     J 6294.592 4788.937
## 29     Ideal     D 2629.095 3001.070
## 30     Ideal     E 2597.550 2956.007
## 31     Ideal     F 3374.939 3766.635
## 32     Ideal     G 3720.706 4006.262
## 33     Ideal     H 3889.335 4013.375
## 34     Ideal     I 4451.970 4505.150
## 35     Ideal     J 4918.186 4476.207</code></pre>
</div>
<p style="text-align: center;">
<a href="6-4-small-multiple-plots.html"><button class="btn btn-default">Previous</button></a>
<a href="6-6-quiz-3.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
