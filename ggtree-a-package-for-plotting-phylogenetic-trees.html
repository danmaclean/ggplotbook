<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.1 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="loading-your-own-data.html">
<link rel="next" href="using-the-stats-functions-in-r.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-r"><i class="fa fa-check"></i><b>1.2</b> Installing R</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installing-rstudio"><i class="fa fa-check"></i><b>1.3</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#installing-r-packages-in-rstudio."><i class="fa fa-check"></i><b>1.4</b> Installing R packages in RStudio.</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#standard-packages"><i class="fa fa-check"></i><b>1.4.1</b> Standard packages</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#bioconductor"><i class="fa fa-check"></i><b>1.4.2</b> Bioconductor</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Motivation</a><ul>
<li class="chapter" data-level="2.1" data-path="motivation.html"><a href="motivation.html#variability-in-measurements"><i class="fa fa-check"></i><b>2.1</b> Variability in measurements</a></li>
<li class="chapter" data-level="2.2" data-path="motivation.html"><a href="motivation.html#summarising-your-data-can-lead-to-wrong-conclusions"><i class="fa fa-check"></i><b>2.2</b> Summarising your data can lead to wrong conclusions</a></li>
<li class="chapter" data-level="2.3" data-path="motivation.html"><a href="motivation.html#ggplot2-an-r-package-for-beautiful-visualisations"><i class="fa fa-check"></i><b>2.3</b> <em>ggplot2</em> An R package for beautiful visualisations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>3</b> R Fundamentals</a><ul>
<li class="chapter" data-level="3.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#about-this-chapter"><i class="fa fa-check"></i><b>3.1</b> About this chapter</a></li>
<li class="chapter" data-level="3.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#working-with-r"><i class="fa fa-check"></i><b>3.2</b> Working with R</a></li>
<li class="chapter" data-level="3.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#variables"><i class="fa fa-check"></i><b>3.3</b> Variables</a><ul>
<li class="chapter" data-level="3.3.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#using-objects-and-functions"><i class="fa fa-check"></i><b>3.3.1</b> Using objects and functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#quiz"><i class="fa fa-check"></i><b>3.4</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2-tour.html"><a href="ggplot2-tour.html"><i class="fa fa-check"></i><b>4</b> <em>ggplot2</em> Tour</a><ul>
<li class="chapter" data-level="4.1" data-path="ggplot2-tour.html"><a href="ggplot2-tour.html#about-this-chapter-1"><i class="fa fa-check"></i><b>4.1</b> About this chapter</a></li>
<li class="chapter" data-level="4.2" data-path="ggplot2-tour.html"><a href="ggplot2-tour.html#building-a-plot-with-ggplot2"><i class="fa fa-check"></i><b>4.2</b> Building a plot with <em>ggplot2</em></a><ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot2-tour.html"><a href="ggplot2-tour.html#loading-the-iris-test-data"><i class="fa fa-check"></i><b>4.2.1</b> Loading the iris test data</a></li>
<li class="chapter" data-level="4.2.2" data-path="ggplot2-tour.html"><a href="ggplot2-tour.html#a-first-plot"><i class="fa fa-check"></i><b>4.2.2</b> A first plot</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ggplot2-tour.html"><a href="ggplot2-tour.html#mappings-versus-assignment"><i class="fa fa-check"></i><b>4.3</b> Mappings versus assignment</a></li>
<li class="chapter" data-level="4.4" data-path="ggplot2-tour.html"><a href="ggplot2-tour.html#quiz-1"><i class="fa fa-check"></i><b>4.4</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="common-geoms.html"><a href="common-geoms.html"><i class="fa fa-check"></i><b>5</b> Common Geoms</a><ul>
<li class="chapter" data-level="5.1" data-path="common-geoms.html"><a href="common-geoms.html#about-this-chapter-2"><i class="fa fa-check"></i><b>5.1</b> About this chapter</a></li>
<li class="chapter" data-level="5.2" data-path="common-geoms.html"><a href="common-geoms.html#continuous-geoms"><i class="fa fa-check"></i><b>5.2</b> Continuous geoms</a><ul>
<li class="chapter" data-level="5.2.1" data-path="common-geoms.html"><a href="common-geoms.html#geom_smooth"><i class="fa fa-check"></i><b>5.2.1</b> geom_smooth()</a></li>
<li class="chapter" data-level="5.2.2" data-path="common-geoms.html"><a href="common-geoms.html#whats-the-r2"><i class="fa fa-check"></i><b>5.2.2</b> What’s the r<sup>2</sup>?</a></li>
<li class="chapter" data-level="5.2.3" data-path="common-geoms.html"><a href="common-geoms.html#geom_jitter"><i class="fa fa-check"></i><b>5.2.3</b> geom_jitter()</a></li>
<li class="chapter" data-level="5.2.4" data-path="common-geoms.html"><a href="common-geoms.html#changing-opacity"><i class="fa fa-check"></i><b>5.2.4</b> Changing opacity</a></li>
<li class="chapter" data-level="5.2.5" data-path="common-geoms.html"><a href="common-geoms.html#geom_histogram"><i class="fa fa-check"></i><b>5.2.5</b> geom_histogram()</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="common-geoms.html"><a href="common-geoms.html#discrete-geoms"><i class="fa fa-check"></i><b>5.3</b> Discrete geoms</a><ul>
<li class="chapter" data-level="5.3.1" data-path="common-geoms.html"><a href="common-geoms.html#geom_point-and-geom_jitter"><i class="fa fa-check"></i><b>5.3.1</b> geom_point() and geom_jitter()</a></li>
<li class="chapter" data-level="5.3.2" data-path="common-geoms.html"><a href="common-geoms.html#geom_boxplot-and-geom_violin"><i class="fa fa-check"></i><b>5.3.2</b> geom_boxplot() and geom_violin()</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="common-geoms.html"><a href="common-geoms.html#quiz-2"><i class="fa fa-check"></i><b>5.4</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="using-factors-to-subset-data-and-plots.html"><a href="using-factors-to-subset-data-and-plots.html"><i class="fa fa-check"></i><b>6</b> Using Factors to Subset Data and Plots</a><ul>
<li class="chapter" data-level="6.1" data-path="using-factors-to-subset-data-and-plots.html"><a href="using-factors-to-subset-data-and-plots.html#about-this-chapter-3"><i class="fa fa-check"></i><b>6.1</b> About this chapter</a></li>
<li class="chapter" data-level="6.2" data-path="using-factors-to-subset-data-and-plots.html"><a href="using-factors-to-subset-data-and-plots.html#factors"><i class="fa fa-check"></i><b>6.2</b> Factors</a></li>
<li class="chapter" data-level="6.3" data-path="using-factors-to-subset-data-and-plots.html"><a href="using-factors-to-subset-data-and-plots.html#colouring-by-factors"><i class="fa fa-check"></i><b>6.3</b> Colouring by factors</a></li>
<li class="chapter" data-level="6.4" data-path="using-factors-to-subset-data-and-plots.html"><a href="using-factors-to-subset-data-and-plots.html#small-multiple-plots"><i class="fa fa-check"></i><b>6.4</b> Small multiple plots</a></li>
<li class="chapter" data-level="6.5" data-path="using-factors-to-subset-data-and-plots.html"><a href="using-factors-to-subset-data-and-plots.html#summary-statistics"><i class="fa fa-check"></i><b>6.5</b> Summary Statistics</a></li>
<li class="chapter" data-level="6.6" data-path="using-factors-to-subset-data-and-plots.html"><a href="using-factors-to-subset-data-and-plots.html#quiz-3"><i class="fa fa-check"></i><b>6.6</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="using-rmarkdown-for-reproducible-publishable-plots.html"><a href="using-rmarkdown-for-reproducible-publishable-plots.html"><i class="fa fa-check"></i><b>7</b> Using RMarkdown for Reproducible Publishable Plots</a><ul>
<li class="chapter" data-level="7.1" data-path="using-rmarkdown-for-reproducible-publishable-plots.html"><a href="using-rmarkdown-for-reproducible-publishable-plots.html#about-this-chapter-4"><i class="fa fa-check"></i><b>7.1</b> About this chapter</a></li>
<li class="chapter" data-level="7.2" data-path="using-rmarkdown-for-reproducible-publishable-plots.html"><a href="using-rmarkdown-for-reproducible-publishable-plots.html#being-lazy-is-a-virtue.-work-hard-to-be-lazy."><i class="fa fa-check"></i><b>7.2</b> Being lazy is a virtue. Work hard to be lazy.</a></li>
<li class="chapter" data-level="7.3" data-path="using-rmarkdown-for-reproducible-publishable-plots.html"><a href="using-rmarkdown-for-reproducible-publishable-plots.html#r-markdown"><i class="fa fa-check"></i><b>7.3</b> R Markdown</a><ul>
<li class="chapter" data-level="7.3.1" data-path="using-rmarkdown-for-reproducible-publishable-plots.html"><a href="using-rmarkdown-for-reproducible-publishable-plots.html#a-new-r-markdown-document"><i class="fa fa-check"></i><b>7.3.1</b> A new R Markdown document</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="using-rmarkdown-for-reproducible-publishable-plots.html"><a href="using-rmarkdown-for-reproducible-publishable-plots.html#quiz-4"><i class="fa fa-check"></i><b>7.4</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visual-customisation.html"><a href="visual-customisation.html"><i class="fa fa-check"></i><b>8</b> Visual Customisation</a><ul>
<li class="chapter" data-level="8.1" data-path="visual-customisation.html"><a href="visual-customisation.html#themes"><i class="fa fa-check"></i><b>8.1</b> Themes</a></li>
<li class="chapter" data-level="8.2" data-path="visual-customisation.html"><a href="visual-customisation.html#quiz-5"><i class="fa fa-check"></i><b>8.2</b> Quiz</a></li>
<li class="chapter" data-level="8.3" data-path="visual-customisation.html"><a href="visual-customisation.html#the-theme-function"><i class="fa fa-check"></i><b>8.3</b> The <code>theme()</code> function</a></li>
<li class="chapter" data-level="8.4" data-path="visual-customisation.html"><a href="visual-customisation.html#changing-the-order-of-categories-in-the-plot"><i class="fa fa-check"></i><b>8.4</b> Changing the order of categories in the plot</a></li>
<li class="chapter" data-level="8.5" data-path="visual-customisation.html"><a href="visual-customisation.html#changing-the-limits-of-a-continuous-scale"><i class="fa fa-check"></i><b>8.5</b> Changing the limits of a continuous scale</a></li>
<li class="chapter" data-level="8.6" data-path="visual-customisation.html"><a href="visual-customisation.html#quiz-6"><i class="fa fa-check"></i><b>8.6</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="loading-your-own-data.html"><a href="loading-your-own-data.html"><i class="fa fa-check"></i><b>9</b> Loading your own data</a><ul>
<li class="chapter" data-level="9.1" data-path="loading-your-own-data.html"><a href="loading-your-own-data.html#tidy-data"><i class="fa fa-check"></i><b>9.1</b> Tidy data</a></li>
<li class="chapter" data-level="9.2" data-path="loading-your-own-data.html"><a href="loading-your-own-data.html#getting-your-data-into-tidy-format"><i class="fa fa-check"></i><b>9.2</b> Getting your data into tidy format</a></li>
<li class="chapter" data-level="9.3" data-path="loading-your-own-data.html"><a href="loading-your-own-data.html#loading-in-a-csv-file"><i class="fa fa-check"></i><b>9.3</b> Loading in a CSV file</a></li>
<li class="chapter" data-level="9.4" data-path="loading-your-own-data.html"><a href="loading-your-own-data.html#finding-the-file"><i class="fa fa-check"></i><b>9.4</b> Finding the file</a><ul>
<li class="chapter" data-level="9.4.1" data-path="loading-your-own-data.html"><a href="loading-your-own-data.html#make-it-easy-on-yourself"><i class="fa fa-check"></i><b>9.4.1</b> Make it easy on yourself</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="loading-your-own-data.html"><a href="loading-your-own-data.html#making-sure-the-data-types-are-correct"><i class="fa fa-check"></i><b>9.5</b> Making sure the data types are correct</a></li>
<li class="chapter" data-level="9.6" data-path="loading-your-own-data.html"><a href="loading-your-own-data.html#quiz-7"><i class="fa fa-check"></i><b>9.6</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ggtree-a-package-for-plotting-phylogenetic-trees.html"><a href="ggtree-a-package-for-plotting-phylogenetic-trees.html"><i class="fa fa-check"></i><b>10</b> <em>ggtree</em> a package for plotting phylogenetic trees</a><ul>
<li class="chapter" data-level="10.1" data-path="ggtree-a-package-for-plotting-phylogenetic-trees.html"><a href="ggtree-a-package-for-plotting-phylogenetic-trees.html#ggtree---a-bioconductor-package-for-displaying-phylogenetic-trees"><i class="fa fa-check"></i><b>10.1</b> <code>ggtree</code> - a Bioconductor package for displaying phylogenetic trees</a><ul>
<li class="chapter" data-level="10.1.1" data-path="ggtree-a-package-for-plotting-phylogenetic-trees.html"><a href="ggtree-a-package-for-plotting-phylogenetic-trees.html#labels"><i class="fa fa-check"></i><b>10.1.1</b> Labels</a></li>
<li class="chapter" data-level="10.1.2" data-path="ggtree-a-package-for-plotting-phylogenetic-trees.html"><a href="ggtree-a-package-for-plotting-phylogenetic-trees.html#annotating-and-colouring-clades"><i class="fa fa-check"></i><b>10.1.2</b> Annotating and colouring clades</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="ggtree-a-package-for-plotting-phylogenetic-trees.html"><a href="ggtree-a-package-for-plotting-phylogenetic-trees.html#quiz-8"><i class="fa fa-check"></i><b>10.2</b> Quiz</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="using-the-stats-functions-in-r.html"><a href="using-the-stats-functions-in-r.html"><i class="fa fa-check"></i><b>11</b> Using the stats functions in R</a><ul>
<li class="chapter" data-level="11.1" data-path="using-the-stats-functions-in-r.html"><a href="using-the-stats-functions-in-r.html#about-this-chapter-5"><i class="fa fa-check"></i><b>11.1</b> About this chapter</a></li>
<li class="chapter" data-level="11.2" data-path="using-the-stats-functions-in-r.html"><a href="using-the-stats-functions-in-r.html#summary-statistics-1"><i class="fa fa-check"></i><b>11.2</b> Summary Statistics</a></li>
<li class="chapter" data-level="11.3" data-path="using-the-stats-functions-in-r.html"><a href="using-the-stats-functions-in-r.html#the-independent-t-test"><i class="fa fa-check"></i><b>11.3</b> The independent <em>t</em> test</a><ul>
<li class="chapter" data-level="11.3.1" data-path="using-the-stats-functions-in-r.html"><a href="using-the-stats-functions-in-r.html#effect-size-for-a-t-test."><i class="fa fa-check"></i><b>11.3.1</b> Effect size for a <em>t</em> test.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="using-the-stats-functions-in-r.html"><a href="using-the-stats-functions-in-r.html#linear-regression"><i class="fa fa-check"></i><b>11.4</b> Linear regression</a></li>
<li class="chapter" data-level="11.5" data-path="using-the-stats-functions-in-r.html"><a href="using-the-stats-functions-in-r.html#one-way-anova"><i class="fa fa-check"></i><b>11.5</b> One Way ANOVA</a></li>
<li class="chapter" data-level="11.6" data-path="using-the-stats-functions-in-r.html"><a href="using-the-stats-functions-in-r.html#quiz-9"><i class="fa fa-check"></i><b>11.6</b> Quiz</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggtree-a-package-for-plotting-phylogenetic-trees" class="section level1">
<h1><span class="header-section-number">10</span> <em>ggtree</em> a package for plotting phylogenetic trees</h1>
<ol style="list-style-type: decimal">
<li>Questions:</li>
</ol>
<ul>
<li>How do I render and annotate a tree from an existing tree file?</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Objectives:</li>
</ol>
<ul>
<li>Understanding the basics of <em>ggtree</em></li>
<li>Annotating Nodes</li>
<li>Grouping Clades</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Keypoints:</li>
</ol>
<ul>
<li>ggtree is a relative of ggplot for trees</li>
<li>ggtree contains many geoms for annotating trees</li>
</ul>
<div id="ggtree---a-bioconductor-package-for-displaying-phylogenetic-trees" class="section level2">
<h2><span class="header-section-number">10.1</span> <code>ggtree</code> - a Bioconductor package for displaying phylogenetic trees</h2>
<p>Bioconductor is a (very) large set of libraries for operating on biological data types <a href="https://www.bioconductor.org/" class="uri">https://www.bioconductor.org/</a> . <code>ggtree</code> is a library inspired by <code>ggplot</code> for drawing trees. Much of what we’ve already seen in <code>ggplot</code> is transferrable to <code>ggtree</code> so the syntax should be familiar.</p>
<blockquote>
<h2 id="installing-ggtree"><span class="header-section-number">10.1</span> Installing <code>ggtree</code></h2>
<p>Installing bioconductor takes a long time and isn’t done in the same way as with other R packages. To install first run this special script in the R console (making sure you have an internet connection) : <code>source(&quot;https://bioconductor.org/biocLite.R&quot;)</code> in the R console (making sure you have an internet connection). Bioconductor libraries can then be installed with the <code>biocLite()</code> function `biocLite(“ggtree”)</p>
</blockquote>
<p><code>ggtree</code> takes a range of common tree formats as input. We’ll use a sample file in <code>newick</code> format. This creates a special sort object called a ‘phylo’ object that knows all sorts of information about the tree.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggtree)
tree &lt;-<span class="st"> </span><span class="kw">read.tree</span>(<span class="st">&quot;data/mammals.nwk&quot;</span>)
<span class="kw">str</span>(tree)</code></pre></div>
<pre><code>## List of 4
##  $ edge       : int [1:13, 1:2] 9 10 10 9 11 12 12 11 13 14 ...
##  $ Nnode      : int 6
##  $ tip.label  : chr [1:8] &quot;raccoon&quot; &quot;bear&quot; &quot;sea_lion&quot; &quot;seal&quot; ...
##  $ edge.length: num [1:13] 0.846 19.2 6.8 3.874 7.53 ...
##  - attr(*, &quot;class&quot;)= chr &quot;phylo&quot;
##  - attr(*, &quot;order&quot;)= chr &quot;cladewise&quot;</code></pre>
<p>The tree can be drawn using the <code>geom_tree()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(tree) +<span class="st"> </span><span class="kw">geom_tree</span>()</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>There is a special theme that sorts out the background for trees:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(tree) +<span class="st"> </span><span class="kw">geom_tree</span>() +<span class="st"> </span><span class="kw">theme_tree</span>()</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-73-1.png" width="672" /> And because you nearly always want these three <code>ggtree</code> provides a utility function to do all of that - <code>ggtree()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggtree</span>(tree)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>With this function we can add layout options</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggtree</span>(tree, <span class="dt">layout =</span> <span class="st">&quot;circular&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<div id="labels" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Labels</h3>
<p>Adding labels to treetips is done with the <code>geom_tiplab()</code> geom.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggtree</span>(tree) +<span class="st"> </span><span class="kw">geom_tiplab</span>(<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">color=</span><span class="st">&quot;purple&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p>Adding the nodes is done with special options to the <code>geom_point()</code> geom. The shape and colour aesthetics are set to the variable <code>isTip</code> which is an internal variable in the tree object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st">  </span><span class="kw">ggtree</span>(tree) +<span class="st"> </span><span class="kw">geom_tiplab</span>(<span class="dt">size=</span><span class="dv">3</span>, <span class="dt">color=</span><span class="st">&quot;purple&quot;</span>)
p +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape=</span>isTip, <span class="dt">color=</span>isTip), <span class="dt">size=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
</div>
<div id="annotating-and-colouring-clades" class="section level3">
<h3><span class="header-section-number">10.1.2</span> Annotating and colouring clades</h3>
<p>More useful is the ability to colour particular bits of the tree. First let’s add a highlight bar to the side of the tree highlighting the sea mammal family. To do this we need to find the first node in the tree common to the clade we want to highlight. For this it’s node number 12 and we use the <code>geom_cladelabel()</code> geom to add. We can use multiple <code>geom_cladelabel()</code> layers for more labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p +<span class="st"> </span><span class="kw">geom_cladelabel</span>(<span class="dt">node=</span><span class="dv">12</span>, <span class="dt">label=</span><span class="st">&quot;Sea Mammals&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-78-1.png" width="672" /> You can also use blocks of colour for this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p +<span class="st"> </span><span class="kw">geom_hilight</span>(<span class="dt">node=</span><span class="dv">12</span>, <span class="dt">fill=</span><span class="st">&quot;steelblue&quot;</span>, <span class="dt">alpha=</span>.<span class="dv">6</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<p>To actually find the node number we need we can use the <code>MRCA()</code> function and pass it a list of labels we want the most recent common ancestor for</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">MRCA</span>(tree, <span class="dt">tip=</span><span class="kw">c</span>(<span class="st">&#39;seal&#39;</span>,<span class="st">&#39;sea_lion&#39;</span>))</code></pre></div>
<pre><code>## [1] 12</code></pre>
<p>You can use this information to colour different parts of the tree, too. First you need to mark the tree objects as having a new <code>group</code> factor with the <code>groupClade()</code>, function and then dynamically colour by the new group factor</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree &lt;-<span class="st"> </span><span class="kw">groupClade</span>(tree, <span class="dt">node=</span><span class="dv">12</span>)
<span class="kw">ggtree</span>(tree, <span class="kw">aes</span>(<span class="dt">color=</span>group, <span class="dt">linetype=</span>group))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<p>And you can preferentially operate on a clade by using the geoms on particular group numbers, here adding a label only to group 1</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree &lt;-<span class="st"> </span><span class="kw">groupClade</span>(tree, <span class="dt">node=</span><span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">13</span>) )
<span class="kw">ggtree</span>(tree, <span class="kw">aes</span>(<span class="dt">color=</span>group, <span class="dt">linetype=</span>group)) +<span class="st"> </span><span class="kw">geom_tiplab</span>(<span class="kw">aes</span>(<span class="dt">subset=</span>(group==<span class="dv">1</span>)))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p>You can work on arbitrarily defined groups with the <code>groupOTU()</code> function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tree &lt;-<span class="st"> </span><span class="kw">groupOTU</span>(tree, <span class="dt">focus=</span><span class="kw">c</span>(<span class="st">&quot;monkey&quot;</span>, <span class="st">&quot;raccoon&quot;</span>))
<span class="kw">ggtree</span>(tree, <span class="kw">aes</span>(<span class="dt">color=</span>group, <span class="dt">linetype=</span>group)) +<span class="st"> </span><span class="kw">geom_tiplab</span>(<span class="kw">aes</span>(<span class="dt">subset=</span>(group==<span class="dv">1</span>)))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
</div>
</div>
<div id="quiz-8" class="section level2">
<h2><span class="header-section-number">10.2</span> Quiz</h2>
<ol style="list-style-type: decimal">
<li>Set up an analysis folder:</li>
<li>Make a new folder called <code>analysis</code> on the Desktop</li>
<li>Inside <code>analysis</code> make a new folder called <code>raw</code> and put <code>pinf_mtDNA.newick</code> into it.</li>
<li>Start a new R Markdown document and save it in <code>analysis</code></li>
<li>Create a circular cladogram of the tree and annotate the tips with tip labels. Rotate them to layout better. Hint: See the documentation <a href="http://bioconductor.org/packages/release/bioc/html/ggtree.html">here</a></li>
<li>Can you add the bootstrap values for each branchpoint?</li>
<li>Find the most recent common ancestor of US5 and PE_6096. Highlight the clade with a coloured box.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="loading-your-own-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-the-stats-functions-in-r.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
